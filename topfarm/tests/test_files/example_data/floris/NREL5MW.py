import numpy as np
from py_wake.wind_turbines import OneTypeWindTurbines
from scipy.special import gamma
from scipy.interpolate import UnivariateSpline
from py_wake.site._site import UniformSite

power_curve = np.array([[2.99000000e+00, 0.00000000e+00],
                       [3.00000000e+00, 3.99687614e+01],
                       [3.13084663e+00, 5.43614085e+01],
                       [3.26169327e+00, 7.00295589e+01],
                       [3.39253990e+00, 8.69684484e+01],
                       [3.52338654e+00, 1.05180946e+02],
                       [3.65423317e+00, 1.24708575e+02],
                       [3.78507980e+00, 1.45619420e+02],
                       [3.91592644e+00, 1.67998568e+02],
                       [4.04677307e+00, 1.91929699e+02],
                       [4.17761971e+00, 2.17201717e+02],
                       [4.30846634e+00, 2.44194855e+02],
                       [4.43931297e+00, 2.72778632e+02],
                       [4.57015961e+00, 3.03043685e+02],
                       [4.70100624e+00, 3.35059883e+02],
                       [4.83185287e+00, 3.68868291e+02],
                       [4.96269951e+00, 4.04443677e+02],
                       [5.09354614e+00, 4.42114561e+02],
                       [5.22439278e+00, 4.81373089e+02],
                       [5.35523941e+00, 5.22810533e+02],
                       [5.48608604e+00, 5.66342176e+02],
                       [5.61693268e+00, 6.11493538e+02],
                       [5.74777931e+00, 6.58921491e+02],
                       [5.87862595e+00, 7.08678030e+02],
                       [6.00947258e+00, 7.60049124e+02],
                       [6.14031921e+00, 8.13452268e+02],
                       [6.27116585e+00, 8.69255774e+02],
                       [6.40201248e+00, 9.27509490e+02],
                       [6.53285912e+00, 9.87835297e+02],
                       [6.66370575e+00, 1.04968368e+03],
                       [6.79455238e+00, 1.11403934e+03],
                       [6.92539902e+00, 1.18095066e+03],
                       [7.05624565e+00, 1.25046598e+03],
                       [7.18709229e+00, 1.32263356e+03],
                       [7.31793892e+00, 1.39669602e+03],
                       [7.44878555e+00, 1.47251539e+03],
                       [7.57963219e+00, 1.55103846e+03],
                       [7.71047882e+00, 1.63231310e+03],
                       [7.84132545e+00, 1.71638721e+03],
                       [7.97217209e+00, 1.80364842e+03],
                       [8.10301872e+00, 1.89392343e+03],
                       [8.23386536e+00, 1.98716154e+03],
                       [8.36471199e+00, 2.08341059e+03],
                       [8.49555862e+00, 2.18271842e+03],
                       [8.62640526e+00, 2.28513289e+03],
                       [8.75725189e+00, 2.39070184e+03],
                       [8.88809853e+00, 2.49947312e+03],
                       [9.01894516e+00, 2.61149458e+03],
                       [9.14979179e+00, 2.72681406e+03],
                       [9.28063843e+00, 2.84547942e+03],
                       [9.41148506e+00, 2.96753850e+03],
                       [9.54233170e+00, 3.09303914e+03],
                       [9.67317833e+00, 3.22202921e+03],
                       [9.80402496e+00, 3.35455653e+03],
                       [9.93487160e+00, 3.49066897e+03],
                       [1.00657182e+01, 3.63041437e+03],
                       [1.01965649e+01, 3.77384057e+03],
                       [1.03274115e+01, 3.92099543e+03],
                       [1.04582581e+01, 4.07192679e+03],
                       [1.05891048e+01, 4.22668250e+03],
                       [1.07199514e+01, 4.38373548e+03],
                       [1.08507980e+01, 4.54437890e+03],
                       [1.09816447e+01, 4.70246960e+03],
                       [1.11124913e+01, 4.86178777e+03],
                       [1.12433379e+01, 5.02464842e+03],
                       [1.13741846e+01, 5.19109031e+03],
                       [1.15050312e+01, 5.36115219e+03],
                       [1.17044877e+01, 5.57324062e+03],
                       [1.17724905e+01, 5.57324062e+03],
                       [1.18408883e+01, 5.57324062e+03],
                       [1.19096835e+01, 5.57324062e+03],
                       [1.19788783e+01, 5.57324062e+03],
                       [1.20484753e+01, 5.57324062e+03],
                       [1.21184765e+01, 5.57324062e+03],
                       [1.21888845e+01, 5.57324062e+03],
                       [1.22597016e+01, 5.57324062e+03],
                       [1.23309300e+01, 5.57324062e+03],
                       [1.24025724e+01, 5.57324062e+03],
                       [1.24746309e+01, 5.57324062e+03],
                       [1.25471081e+01, 5.57324062e+03],
                       [1.26200065e+01, 5.57324062e+03],
                       [1.26933283e+01, 5.57324062e+03],
                       [1.27670762e+01, 5.57324062e+03],
                       [1.28412525e+01, 5.57324062e+03],
                       [1.29158598e+01, 5.57324062e+03],
                       [1.29909005e+01, 5.57324062e+03],
                       [1.30663772e+01, 5.57324062e+03],
                       [1.31422925e+01, 5.57324062e+03],
                       [1.32186488e+01, 5.57324062e+03],
                       [1.32954487e+01, 5.57324062e+03],
                       [1.33726949e+01, 5.57324062e+03],
                       [1.34503898e+01, 5.57324062e+03],
                       [1.35285362e+01, 5.57324062e+03],
                       [1.36071366e+01, 5.57324062e+03],
                       [1.36861936e+01, 5.57324062e+03],
                       [1.37657100e+01, 5.57324062e+03],
                       [1.38456883e+01, 5.57324062e+03],
                       [1.39261313e+01, 5.57324062e+03],
                       [1.40070417e+01, 5.57324062e+03],
                       [1.40884222e+01, 5.57324062e+03],
                       [1.41702755e+01, 5.57324062e+03],
                       [1.42526044e+01, 5.57324062e+03],
                       [1.43354116e+01, 5.57324062e+03],
                       [1.44186999e+01, 5.57324062e+03],
                       [1.45024721e+01, 5.57324062e+03],
                       [1.45867310e+01, 5.57324062e+03],
                       [1.46714794e+01, 5.57324062e+03],
                       [1.47567203e+01, 5.57324062e+03],
                       [1.48424564e+01, 5.57324062e+03],
                       [1.49286906e+01, 5.57324062e+03],
                       [1.50154258e+01, 5.57324062e+03],
                       [1.51026650e+01, 5.57324062e+03],
                       [1.51904110e+01, 5.57324062e+03],
                       [1.52786668e+01, 5.57324062e+03],
                       [1.53674354e+01, 5.57324062e+03],
                       [1.54567197e+01, 5.57324062e+03],
                       [1.55465228e+01, 5.57324062e+03],
                       [1.56368476e+01, 5.57324062e+03],
                       [1.57276972e+01, 5.57324062e+03],
                       [1.58190747e+01, 5.57324062e+03],
                       [1.59109830e+01, 5.57324062e+03],
                       [1.60034253e+01, 5.57324062e+03],
                       [1.60964047e+01, 5.57324062e+03],
                       [1.61899243e+01, 5.57324062e+03],
                       [1.62839873e+01, 5.57324062e+03],
                       [1.63785968e+01, 5.57324062e+03],
                       [1.64737559e+01, 5.57324062e+03],
                       [1.65694679e+01, 5.57324062e+03],
                       [1.66657360e+01, 5.57324062e+03],
                       [1.67625634e+01, 5.57324062e+03],
                       [1.68599534e+01, 5.57324062e+03],
                       [1.69579092e+01, 5.57324062e+03],
                       [1.70564342e+01, 5.57324062e+03],
                       [1.71555315e+01, 5.57324062e+03],
                       [1.72552046e+01, 5.57324062e+03],
                       [1.73554568e+01, 5.57324062e+03],
                       [1.74562915e+01, 5.57324062e+03],
                       [1.75577120e+01, 5.57324062e+03],
                       [1.76597218e+01, 5.57324062e+03],
                       [1.77623242e+01, 5.57324062e+03],
                       [1.78655228e+01, 5.57324062e+03],
                       [1.79693209e+01, 5.57324062e+03],
                       [1.80737221e+01, 5.57324062e+03],
                       [1.81787299e+01, 5.57324062e+03],
                       [1.82843477e+01, 5.57324062e+03],
                       [1.83905792e+01, 5.57324062e+03],
                       [1.84974279e+01, 5.57324062e+03],
                       [1.86048974e+01, 5.57324062e+03],
                       [1.87129913e+01, 5.57324062e+03],
                       [1.88217132e+01, 5.57324062e+03],
                       [1.89310668e+01, 5.57324062e+03],
                       [1.90410557e+01, 5.57324062e+03],
                       [1.91516836e+01, 5.57324062e+03],
                       [1.92629543e+01, 5.57324062e+03],
                       [1.93748715e+01, 5.57324062e+03],
                       [1.94874389e+01, 5.57324062e+03],
                       [1.96006603e+01, 5.57324062e+03],
                       [1.97145396e+01, 5.57324062e+03],
                       [1.98290804e+01, 5.57324062e+03],
                       [1.99442868e+01, 5.57324062e+03],
                       [2.00601625e+01, 5.57324062e+03],
                       [2.01767114e+01, 5.57324062e+03],
                       [2.02939375e+01, 5.57324062e+03],
                       [2.04118446e+01, 5.57324062e+03],
                       [2.05304368e+01, 5.57324062e+03],
                       [2.06497180e+01, 5.57324062e+03],
                       [2.07696922e+01, 5.57324062e+03],
                       [2.08903635e+01, 5.57324062e+03],
                       [2.10117359e+01, 5.57324062e+03],
                       [2.11338134e+01, 5.57324062e+03],
                       [2.12566002e+01, 5.57324062e+03],
                       [2.13801004e+01, 5.57324062e+03],
                       [2.15043181e+01, 5.57324062e+03],
                       [2.16292576e+01, 5.57324062e+03],
                       [2.17549229e+01, 5.57324062e+03],
                       [2.18813183e+01, 5.57324062e+03],
                       [2.20084481e+01, 5.57324062e+03],
                       [2.21363165e+01, 5.57324062e+03],
                       [2.22649278e+01, 5.57324062e+03],
                       [2.23942864e+01, 5.57324062e+03],
                       [2.25243965e+01, 5.57324062e+03],
                       [2.26552625e+01, 5.57324062e+03],
                       [2.27868889e+01, 5.57324062e+03],
                       [2.29192800e+01, 5.57324062e+03],
                       [2.30524403e+01, 5.57324062e+03],
                       [2.31863743e+01, 5.57324062e+03],
                       [2.33210864e+01, 5.57324062e+03],
                       [2.34565812e+01, 5.57324062e+03],
                       [2.35928632e+01, 5.57324062e+03],
                       [2.37299370e+01, 5.57324062e+03],
                       [2.38678072e+01, 5.57324062e+03],
                       [2.40064785e+01, 5.57324062e+03],
                       [2.41459554e+01, 5.57324062e+03],
                       [2.42862426e+01, 5.57324062e+03],
                       [2.44273449e+01, 5.57324062e+03],
                       [2.45692671e+01, 5.57324062e+03],
                       [2.47120138e+01, 5.57324062e+03],
                       [2.48555898e+01, 5.57324062e+03],
                       [2.50000000e+01, 5.57324062e+03],
                       [2.50010000e+01, 5.57324062e+03]])
power_curve[:, 1] = power_curve[:, 1] / max(power_curve[:, 1]) * 5000  # converting from aerodynamic to electrical power. The source of these numbers is PlantEnergy.

ct_curve = np.array([
    [2.990000000, 0.060922950],
    [3.000000000, 1.000000000],
    [3.130846630, 0.982226694],
    [3.261693270, 0.965220573],
    [3.392539900, 0.949069042],
    [3.523386540, 0.933848937],
    [3.654233170, 0.919533999],
    [3.785079800, 0.906067021],
    [3.915926440, 0.893396238],
    [4.046773070, 0.881480643],
    [4.177619710, 0.870136874],
    [4.308466340, 0.859463822],
    [4.439312970, 0.849347547],
    [4.570159610, 0.839740605],
    [4.701006240, 0.830640905],
    [4.831852870, 0.821983214],
    [4.962699510, 0.813733765],
    [5.093546140, 0.805971425],
    [5.224392780, 0.798412662],
    [5.355239410, 0.791309925],
    [5.486086040, 0.784545267],
    [5.616932680, 0.777882868],
    [5.747779310, 0.771603738],
    [5.878625950, 0.765681524],
    [6.009472580, 0.759759201],
    [6.140319210, 0.754037497],
    [6.271165850, 0.748632022],
    [6.402012480, 0.743522677],
    [6.532859120, 0.738535306],
    [6.663705750, 0.733485249],
    [6.794552380, 0.728706149],
    [6.925399020, 0.724181962],
    [7.056245650, 0.719897823],
    [7.187092290, 0.715839970],
    [7.317938920, 0.711779844],
    [7.448785550, 0.707686955],
    [7.579632190, 0.703808027],
    [7.710478820, 0.700131525],
    [7.841325450, 0.696646677],
    [7.972172090, 0.695874880],
    [8.103018720, 0.695874880],
    [8.233865360, 0.695874880],
    [8.364711990, 0.695874880],
    [8.495558620, 0.695874880],
    [8.626405260, 0.695874880],
    [8.757251890, 0.695874880],
    [8.888098530, 0.695874880],
    [9.018945160, 0.695874880],
    [9.149791790, 0.695874880],
    [9.280638430, 0.695874880],
    [9.411485060, 0.695874880],
    [9.542331700, 0.695874880],
    [9.673178330, 0.695874880],
    [9.804024960, 0.695874880],
    [9.934871600, 0.695874880],
    [10.065718230, 0.695874880],
    [10.196564870, 0.695874880],
    [10.327411500, 0.695874880],
    [10.458258130, 0.695874880],
    [10.589104770, 0.695874880],
    [10.719951400, 0.691048298],
    [10.850798030, 0.685592729],
    [10.981644670, 0.679741473],
    [11.112491300, 0.673839622],
    [11.243337940, 0.668075148],
    [11.374184570, 0.662443295],
    [11.505031200, 0.656939550],
    [11.635877840, 0.650885584],
    [11.636877840, 0.650242334],
    [11.704487740, 0.613707517],
    [11.772490450, 0.588051732],
    [11.840888260, 0.567057009],
    [11.909683460, 0.548670047],
    [11.978878350, 0.531939412],
    [12.048475260, 0.516457611],
    [12.118476530, 0.502415099],
    [12.188884510, 0.488954567],
    [12.259701550, 0.476538551],
    [12.330930040, 0.464558408],
    [12.402572360, 0.453390057],
    [12.474630930, 0.442507391],
    [12.547108150, 0.432374726],
    [12.620006460, 0.422203482],
    [12.693328310, 0.412601781],
    [12.767076160, 0.403282259],
    [12.841252470, 0.394269642],
    [12.915859760, 0.385710229],
    [12.990900500, 0.377300694],
    [13.066377230, 0.369285066],
    [13.142292480, 0.361534303],
    [13.218648800, 0.353920243],
    [13.295448740, 0.346717429],
    [13.372694890, 0.339679988],
    [13.450389830, 0.332767105],
    [13.528536180, 0.326244731],
    [13.607136560, 0.319787334],
    [13.686193610, 0.313189008],
    [13.765709970, 0.306969724],
    [13.845688320, 0.300860368],
    [13.926131340, 0.294851756],
    [14.007041740, 0.289119478],
    [14.088422220, 0.283519565],
    [14.170275520, 0.278011995],
    [14.252604380, 0.272715399],
    [14.335411570, 0.267582670],
    [14.418699870, 0.262537005],
    [14.502472070, 0.257632535],
    [14.586730990, 0.252930292],
    [14.671479450, 0.248309689],
    [14.756720290, 0.243770162],
    [14.842456380, 0.239377161],
    [14.928690600, 0.234809401],
    [15.015425830, 0.230358299],
    [15.102664990, 0.226054993],
    [15.190411010, 0.221884545],
    [15.278666830, 0.217773650],
    [15.367435410, 0.213740689],
    [15.456719740, 0.209895810],
    [15.546522800, 0.206116072],
    [15.636847620, 0.202401248],
    [15.727697220, 0.198809958],
    [15.819074660, 0.195336779],
    [15.910983000, 0.191926148],
    [16.003425320, 0.188577883],
    [16.096404730, 0.185393539],
    [16.189924340, 0.182271204],
    [16.283987300, 0.179209454],
    [16.378596770, 0.175898014],
    [16.473755910, 0.172722729],
    [16.569467920, 0.169598632],
    [16.665736020, 0.166525568],
    [16.762563430, 0.163569849],
    [16.859953410, 0.160681088],
    [16.957909220, 0.157842466],
    [17.056434150, 0.155065926],
    [17.155531510, 0.152403552],
    [17.255204620, 0.149790313],
    [17.355456820, 0.147226491],
    [17.456291490, 0.144750337],
    [17.557712010, 0.142354747],
    [17.659721780, 0.140008081],
    [17.762324210, 0.137710322],
    [17.865522770, 0.135522930],
    [17.969320910, 0.133386544],
    [18.073722110, 0.131298754],
    [18.178729880, 0.128926192],
    [18.284347740, 0.126641326],
    [18.390579230, 0.124392892],
    [18.497427930, 0.122182910],
    [18.604897420, 0.120043548],
    [18.712991300, 0.117964606],
    [18.821713200, 0.115923129],
    [18.931066780, 0.113917656],
    [19.041055690, 0.112003923],
    [19.151683640, 0.110121747],
    [19.262954330, 0.108284670],
    [19.374871500, 0.106505082],
    [19.487438910, 0.104788234],
    [19.600660330, 0.103110376],
    [19.714539560, 0.101471443],
    [19.829080430, 0.099908856],
    [19.944286770, 0.098389769],
    [20.060162470, 0.096909526],
    [20.176711390, 0.095482582],
    [20.293937460, 0.094118331],
    [20.411844610, 0.092494264],
    [20.530436800, 0.090832979],
    [20.649718010, 0.089230032],
    [20.769692230, 0.087662441],
    [20.890363500, 0.086124198],
    [21.011735870, 0.084622360],
    [21.133813410, 0.083174824],
    [21.256600220, 0.081757969],
    [21.380100410, 0.080370864],
    [21.504318130, 0.079034189],
    [21.629257560, 0.077737408],
    [21.754922880, 0.076471573],
    [21.881318310, 0.075241422],
    [22.008448090, 0.074064258],
    [22.136316500, 0.072918323],
    [22.264927820, 0.071802840],
    [22.394286360, 0.070736994],
    [22.524396470, 0.069710247],
    [22.655262520, 0.068713524],
    [22.786888900, 0.067753991],
    [22.919280020, 0.066844131],
    [23.052440330, 0.065964094],
    [23.186374300, 0.065114244],
    [23.321086420, 0.063960338],
    [23.456581220, 0.062809390],
    [23.592863230, 0.061679498],
    [23.729937040, 0.060578196],
    [23.867807240, 0.059512980],
    [24.006478470, 0.058469267],
    [24.145955370, 0.057447068],
    [24.286242620, 0.056466753],
    [24.427344940, 0.055511055],
    [24.569267070, 0.054577153],
    [24.712013750, 0.053673640],
    [24.855589790, 0.052809774],
    [25.000000000, 0.054819420],
    [25.001000000, 0.054819420]])

cp_curve = np.array([
    [2.990000000, 0.000000000],
    [3.000000000, 0.192604670],
    [3.130846630, 0.230470420],
    [3.261693270, 0.262580170],
    [3.392539900, 0.289798880],
    [3.523386540, 0.312871550],
    [3.654233170, 0.332519740],
    [3.785079800, 0.349384840],
    [3.915926440, 0.364008800],
    [4.046773070, 0.376812680],
    [4.177619710, 0.387602370],
    [4.308466340, 0.397263140],
    [4.439312970, 0.405670040],
    [4.570159610, 0.413067490],
    [4.701006240, 0.419623520],
    [4.831852870, 0.425441740],
    [4.962699510, 0.430540480],
    [5.093546140, 0.435295280],
    [5.224392780, 0.439222140],
    [5.355239410, 0.442912090],
    [5.486086040, 0.446273330],
    [5.616932680, 0.448956320],
    [5.747779310, 0.451484970],
    [5.878625950, 0.453869880],
    [6.009472580, 0.455661640],
    [6.140319210, 0.457160930],
    [6.271165850, 0.458577350],
    [6.402012480, 0.459916180],
    [6.532859120, 0.460982610],
    [6.663705750, 0.461552270],
    [6.794552380, 0.462091360],
    [6.925399020, 0.462601710],
    [7.056245650, 0.463084970],
    [7.187092290, 0.463542710],
    [7.317938920, 0.463708900],
    [7.448785550, 0.463567850],
    [7.579632190, 0.463434170],
    [7.710478820, 0.463307470],
    [7.841325450, 0.463187370],
    [7.972172090, 0.463160770],
    [8.103018720, 0.463160770],
    [8.233865360, 0.463160770],
    [8.364711990, 0.463160770],
    [8.495558620, 0.463160770],
    [8.626405260, 0.463160770],
    [8.757251890, 0.463160770],
    [8.888098530, 0.463160770],
    [9.018945160, 0.463160770],
    [9.149791790, 0.463160770],
    [9.280638430, 0.463160770],
    [9.411485060, 0.463160770],
    [9.542331700, 0.463160770],
    [9.673178330, 0.463160770],
    [9.804024960, 0.463160770],
    [9.934871600, 0.463160770],
    [10.065718230, 0.463160770],
    [10.196564870, 0.463160770],
    [10.327411500, 0.463160770],
    [10.458258130, 0.463160770],
    [10.589104770, 0.463160770],
    [10.719951400, 0.462994430],
    [10.850798030, 0.462806420],
    [10.981644670, 0.461991210],
    [11.112491300, 0.460968840],
    [11.243337940, 0.459970270],
    [11.374184570, 0.458994680],
    [11.505031200, 0.458041270],
    [11.704487740, 0.452231110],
    [11.772490450, 0.444439480],
    [11.840888260, 0.436782090],
    [11.909683460, 0.429256630],
    [11.978878350, 0.421860830],
    [12.048475260, 0.414592460],
    [12.118476530, 0.407449320],
    [12.188884510, 0.400429240],
    [12.259701550, 0.393530120],
    [12.330930040, 0.386749860],
    [12.402572360, 0.380086430],
    [12.474630930, 0.373537800],
    [12.547108150, 0.367102000],
    [12.620006460, 0.360777080],
    [12.693328310, 0.354561140],
    [12.767076160, 0.348452290],
    [12.841252470, 0.342448700],
    [12.915859760, 0.336548540],
    [12.990900500, 0.330750040],
    [13.066377230, 0.325051440],
    [13.142292480, 0.319451030],
    [13.218648800, 0.313947100],
    [13.295448740, 0.308538010],
    [13.372694890, 0.303222110],
    [13.450389830, 0.297997800],
    [13.528536180, 0.292863500],
    [13.607136560, 0.287817660],
    [13.686193610, 0.282858760],
    [13.765709970, 0.277985300],
    [13.845688320, 0.273195800],
    [13.926131340, 0.268488820],
    [14.007041740, 0.263862940],
    [14.088422220, 0.259316770],
    [14.170275520, 0.254848910],
    [14.252604380, 0.250458040],
    [14.335411570, 0.246142820],
    [14.418699870, 0.241901950],
    [14.502472070, 0.237734140],
    [14.586730990, 0.233638150],
    [14.671479450, 0.229612720],
    [14.756720290, 0.225656650],
    [14.842456380, 0.221768740],
    [14.928690600, 0.217947820],
    [15.015425830, 0.214192720],
    [15.102664990, 0.210502330],
    [15.190411010, 0.206875520],
    [15.278666830, 0.203311190],
    [15.367435410, 0.199808280],
    [15.456719740, 0.196365720],
    [15.546522800, 0.192982470],
    [15.636847620, 0.189657520],
    [15.727697220, 0.186389850],
    [15.819074660, 0.183178480],
    [15.910983000, 0.180022440],
    [16.003425320, 0.176920770],
    [16.096404730, 0.173872550],
    [16.189924340, 0.170876840],
    [16.283987300, 0.167932750],
    [16.378596770, 0.165039390],
    [16.473755910, 0.162195870],
    [16.569467920, 0.159401350],
    [16.665736020, 0.156654970],
    [16.762563430, 0.153955910],
    [16.859953410, 0.151303360],
    [16.957909220, 0.148696500],
    [17.056434150, 0.146134560],
    [17.155531510, 0.143616760],
    [17.255204620, 0.141142350],
    [17.355456820, 0.138710560],
    [17.456291490, 0.136320670],
    [17.557712010, 0.133971960],
    [17.659721780, 0.131663710],
    [17.762324210, 0.129395240],
    [17.865522770, 0.127165850],
    [17.969320910, 0.124974870],
    [18.073722110, 0.122821630],
    [18.178729880, 0.120705500],
    [18.284347740, 0.118625830],
    [18.390579230, 0.116581990],
    [18.497427930, 0.114573360],
    [18.604897420, 0.112599340],
    [18.712991300, 0.110659330],
    [18.821713200, 0.108752740],
    [18.931066780, 0.106879010],
    [19.041055690, 0.105037550],
    [19.151683640, 0.103227830],
    [19.262954330, 0.101449280],
    [19.374871500, 0.099701380],
    [19.487438910, 0.097983600],
    [19.600660330, 0.096295400],
    [19.714539560, 0.094636300],
    [19.829080430, 0.093005780],
    [19.944286770, 0.091403360],
    [20.060162470, 0.089828540],
    [20.176711390, 0.088280850],
    [20.293937460, 0.086759840],
    [20.411844610, 0.085265020],
    [20.530436800, 0.083795960],
    [20.649718010, 0.082352220],
    [20.769692230, 0.080933340],
    [20.890363500, 0.079538920],
    [21.011735870, 0.078168520],
    [21.133813410, 0.076821730],
    [21.256600220, 0.075498140],
    [21.380100410, 0.074197360],
    [21.504318130, 0.072918990],
    [21.629257560, 0.071662650],
    [21.754922880, 0.070427950],
    [21.881318310, 0.069214520],
    [22.008448090, 0.068022000],
    [22.136316500, 0.066850030],
    [22.264927820, 0.065698250],
    [22.394286360, 0.064566310],
    [22.524396470, 0.063453880],
    [22.655262520, 0.062360610],
    [22.786888900, 0.061286180],
    [22.919280020, 0.060230260],
    [23.052440330, 0.059192540],
    [23.186374300, 0.058172690],
    [23.321086420, 0.057170410],
    [23.456581220, 0.056185410],
    [23.592863230, 0.055217370],
    [23.729937040, 0.054266010],
    [23.867807240, 0.053331050],
    [24.006478470, 0.052412190],
    [24.145955370, 0.051509160],
    [24.286242620, 0.050621700],
    [24.427344940, 0.049749520],
    [24.569267070, 0.048892370],
    [24.712013750, 0.048049990],
    [24.855589790, 0.047222120],
    [25.000000000, 0.046408510],
    [25.001000000, 0.046402940]])

cp_curve_spline = UnivariateSpline(cp_curve[:, 0], cp_curve[:, 1], ext='const')
cp_curve_spline.set_smoothing_factor(.000001)


class Nrel5MW(OneTypeWindTurbines):
    def __init__(self):
        OneTypeWindTurbines.__init__(self, 'Nrel5MW', diameter=126.4, hub_height=90,
                                     ct_func=self._ct, power_func=self._power, power_unit='kW')

    def _ct(self, u):
        return np.interp(u, ct_curve[:, 0], ct_curve[:, 1])

    def _power(self, u):
        return np.interp(u, power_curve[:, 0], power_curve[:, 1])


NREL5MWREF = Nrel5MW


class Amalia1Site(UniformSite):
    def __init__(self, f=[3.597152, 3.948682, 5.167395, 7.000154, 8.364547, 6.43485,
                          8.643194, 11.77051, 15.15757, 14.73792, 10.01205, 5.165975], mean_wsp=8):
        UniformSite.__init__(self, p_wd=f, ti=0.1, ws=mean_wsp)


def main():
    if __name__ == '__main__':
        wt = NREL5MWREF()
        print('Diameter', wt.diameter())
        print('Hub height', wt.hub_height())
        ws = np.arange(3, 25)
        import matplotlib.pyplot as plt
        plt.plot(ws, wt.power(ws), '.-')
        plt.show()


main()
